<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>PDF 오탈자 검사기</title>
</head>
<body>
<h1>PDF 오탈자 검사기</h1>
<form id="form">
  <div>
    <label>PDF 파일: <input type="file" name="pdf" accept="application/pdf" required></label>
  </div>
  <fieldset>
    <legend>검사기 선택</legend>
    <label><input type="checkbox" name="checkers" value="hanspell" checked> Hanspell</label>
    <label><input type="checkbox" name="checkers" value="spacing" checked> Spacing</label>
    <label><input type="checkbox" name="checkers" value="rule" checked> Rule</label>
    <label><input type="checkbox" name="checkers" value="languagetool" checked> LanguageTool</label>
  </fieldset>
  <div>
    <label>출력 형식:
      <select name="format">
        <option value="both">CSV & XLSX</option>
        <option value="csv">CSV</option>
        <option value="xlsx">XLSX</option>
      </select>
    </label>
  </div>
  <button type="submit">검수 시작</button>
</form>
<div id="result"></div>
<script>
const form = document.getElementById('form');
form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const fd = new FormData(form);
  const res = await fetch('/api/process', {method: 'POST', body: fd});
  const data = await res.json();
  const result = document.getElementById('result');
  if (data.error) {
    result.textContent = data.error;
    return;
  }
  let html = '';
  if (data.csv) html += `<a href="${data.csv}" download>CSV 다운로드</a><br>`;
  if (data.xlsx) html += `<a href="${data.xlsx}" download>XLSX 다운로드</a><br>`;
  if (!html) html = '파일이 생성되지 않았습니다.';
  result.innerHTML = html + '<p><a href="viewer.html" target="_blank">viewer.html로 열기</a></p>';
});
</script>
</body>
</html>
